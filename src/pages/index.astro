---
import { getCollection } from "astro:content";
import PageLayout from "@layouts/PageLayout.astro";
import ArrowCard from "@components/ArrowCard";
import ParticleCanvas from "@components/ParticleCanvas.astro";
import { SOCIALS } from "@consts";

const posts = (await getCollection("blog"))
  .filter((post) => !post.data.draft)
  .sort((a, b) => b.data.date.getTime() - a.data.date.getTime())
  .slice(0, 4);

// Just getting the latest 2 projects for the split grid
const projects = (await getCollection("projects"))
  .filter((project) => !project.data.draft)
  .sort((a, b) => b.data.date.getTime() - a.data.date.getTime())
  .slice(0, 2);
---

<PageLayout title="Home">
  <ParticleCanvas />

  <!-- HERO -->
  <div class="relative min-h-[90vh] flex flex-col justify-center">
    <div class="mx-auto max-w-screen-lg p-5 w-full">
      <section class="relative w-full animate">
        <h1 class="font-display text-5xl md:text-7xl lg:text-8xl font-bold tracking-tight text-foreground mb-4">
          Sagar Arora
        </h1>
        <p class="text-xl md:text-2xl text-foreground opacity-80 font-display max-w-2xl leading-relaxed">
          Generative Artist & Software Engineer
        </p>
      </section>
    </div>
  </div>

  <div class="relative bg-background border-t border-card-border overflow-hidden">
    <div class="mx-auto max-w-screen-lg p-5 space-y-32 pb-24 pt-24">
      
      <!-- About Section -->
      <section class="animate grid grid-cols-1 md:grid-cols-12 gap-12 items-center">
        <div class="md:col-span-7">
          <article class="prose max-w-full text-subtle">
            <h2 class="font-display text-3xl font-bold text-foreground mb-6">About</h2>
            <p>
              I am a software engineer and a generative artist. Also, I like to play chess, guitar, flute, and consume a lot of multimedia.
            </p>
            <p>
              During my career, I have built products ranging from marketing and ecommerce websites to complex shaders and animations with a focus on delivering fast, elegant code.
            </p>
            <p>
              Now, I work as a freelance software engineer, where my duties are product/shader planning, design and development.
            </p>
            
            <h3 class="font-display text-xl text-foreground mt-8 mb-4">Core Stack</h3>
            <div class="flex flex-wrap gap-2">
              {['Three.js', 'WebGL', 'GLSL', 'p5.js', 'React', 'TypeScript', 'Astro'].map(skill => (
                <span class="px-3 py-1 text-xs font-mono bg-card border border-card-border rounded-full text-foreground shadow-sm">
                  {skill}
                </span>
              ))}
            </div>
          </article>
        </div>
        
        <div class="md:col-span-5 relative group hidden md:block">
          <div class="absolute inset-0 bg-accent blur-[80px] opacity-10 group-hover:opacity-30 transition-opacity duration-700 rounded-full mix-blend-screen"></div>
          <div class="relative aspect-[4/5] w-full max-w-xs mx-auto overflow-hidden rounded-2xl border border-card-border shadow-xl">
             <img
              src="/sagar.jpg"
              alt="Sagar Arora"
              class="w-full h-full object-cover filter grayscale contrast-125 group-hover:grayscale-0 group-hover:scale-105 transition-all duration-700 ease-in-out"
            />
          </div>
        </div>
      </section>

      <!-- Selected Writing -->
      <section class="animate">
        <div class="space-y-8">
          <div class="flex justify-between items-end border-b border-card-border pb-4">
            <h2 class="font-display text-3xl font-bold text-foreground m-0">Selected Writing</h2>
            <a
              href="/blog"
              class="group flex gap-2 items-center text-subtle hover:text-accent transition-colors duration-300 font-medium"
            >
              View all
              <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="transition-transform duration-300 group-hover:translate-x-1">
                <line x1="5" y1="12" x2="19" y2="12"></line>
                <polyline points="12 5 19 12 12 19"></polyline>
              </svg>
            </a>
          </div>
          <ul class="grid grid-cols-1 md:grid-cols-2 gap-6">
            {
              posts.map((post) => (
                <li class="h-full">
                  <ArrowCard entry={post} />
                </li>
              ))
            }
          </ul>
        </div>
      </section>

      <!-- Let's Talk Section -->
      <section class="animate bg-card border border-card-border rounded-3xl p-8 md:p-12 relative overflow-hidden">
        <div class="absolute top-0 right-0 w-64 h-64 bg-accent blur-[100px] opacity-10 rounded-full translate-x-1/2 -translate-y-1/2 pointer-events-none"></div>
        <div class="relative z-10 flex flex-col md:flex-row gap-8 justify-between items-start md:items-center">
          <div class="max-w-md">
            <h2 class="font-display text-3xl font-bold text-foreground mb-4">
              Let's Talk
            </h2>
            <p class="text-subtle mb-0">
              I am currently available for freelance work. Whether you have a project in mind or just want to say hi, feel free to reach out.
            </p>
          </div>
          
          <div class="flex flex-col gap-4 w-full md:w-auto">
            <a href="mailto:sgrarora2@gmail.com" class="bg-foreground text-background hover:bg-accent hover:text-white px-8 py-3 rounded-full font-medium transition-colors duration-300 text-center">
              Send an Email
            </a>
            <div class="flex gap-4 justify-center">
              {
                SOCIALS.filter(s => s.NAME !== "Email").map((social) => (
                  <a
                    href={social.HREF}
                    target="_blank"
                    class="size-12 rounded-full border border-card-border flex items-center justify-center text-subtle hover:text-accent hover:border-accent transition-colors duration-300"
                    aria-label={`Visit ${social.NAME}`}
                  >
                     <svg class="size-5 fill-current">
                      <use href={`/social.svg#${social.ICON}`} />
                    </svg>
                  </a>
                ))
              }
            </div>
          </div>
        </div>
      </section>
      
    </div>
  </div>
</PageLayout>
